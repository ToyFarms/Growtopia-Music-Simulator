var Q=Object.defineProperty;var q=(t,r,e)=>r in t?Q(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var d=(t,r,e)=>q(t,typeof r!="symbol"?r+"":r,e);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();var B=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function z(){var t=new B(16);return B!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function J(t,r){var e=r[0],i=r[1],s=r[2],o=r[3],n=r[4],a=r[5],h=r[6],c=r[7],l=r[8],f=r[9],m=r[10],T=r[11],g=r[12],u=r[13],E=r[14],_=r[15],R=e*a-i*n,v=e*h-s*n,N=e*c-o*n,S=i*h-s*a,L=i*c-o*a,x=s*c-o*h,F=l*u-f*g,C=l*E-m*g,w=l*_-T*g,O=f*E-m*u,I=f*_-T*u,b=m*_-T*E,A=R*b-v*I+N*O+S*w-L*C+x*F;return A?(A=1/A,t[0]=(a*b-h*I+c*O)*A,t[1]=(s*I-i*b-o*O)*A,t[2]=(u*x-E*L+_*S)*A,t[3]=(m*L-f*x-T*S)*A,t[4]=(h*w-n*b-c*C)*A,t[5]=(e*b-s*w+o*C)*A,t[6]=(E*N-g*x-_*v)*A,t[7]=(l*x-m*N+T*v)*A,t[8]=(n*I-a*w+c*F)*A,t[9]=(i*w-e*I-o*F)*A,t[10]=(g*L-u*N+_*R)*A,t[11]=(f*N-l*L-T*R)*A,t[12]=(a*C-n*O-h*F)*A,t[13]=(e*O-i*C+s*F)*A,t[14]=(u*v-g*S-E*R)*A,t[15]=(l*S-f*v+m*R)*A,t):null}function y(t,r,e){var i=e[0],s=e[1],o=e[2],n,a,h,c,l,f,m,T,g,u,E,_;return r===t?(t[12]=r[0]*i+r[4]*s+r[8]*o+r[12],t[13]=r[1]*i+r[5]*s+r[9]*o+r[13],t[14]=r[2]*i+r[6]*s+r[10]*o+r[14],t[15]=r[3]*i+r[7]*s+r[11]*o+r[15]):(n=r[0],a=r[1],h=r[2],c=r[3],l=r[4],f=r[5],m=r[6],T=r[7],g=r[8],u=r[9],E=r[10],_=r[11],t[0]=n,t[1]=a,t[2]=h,t[3]=c,t[4]=l,t[5]=f,t[6]=m,t[7]=T,t[8]=g,t[9]=u,t[10]=E,t[11]=_,t[12]=n*i+l*s+g*o+r[12],t[13]=a*i+f*s+u*o+r[13],t[14]=h*i+m*s+E*o+r[14],t[15]=c*i+T*s+_*o+r[15]),t}function K(t,r,e){var i=e[0],s=e[1],o=e[2];return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=r[3]*i,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=r[7]*s,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=r[11]*o,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function tt(t,r,e){var i=Math.sin(e),s=Math.cos(e),o=r[0],n=r[1],a=r[2],h=r[3],c=r[4],l=r[5],f=r[6],m=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*s+c*i,t[1]=n*s+l*i,t[2]=a*s+f*i,t[3]=h*s+m*i,t[4]=c*s-o*i,t[5]=l*s-n*i,t[6]=f*s-a*i,t[7]=m*s-h*i,t}function rt(t,r,e,i,s,o,n){var a=1/(r-e),h=1/(i-s),c=1/(o-n);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+e)*a,t[13]=(s+i)*h,t[14]=(n+o)*c,t[15]=1,t}var et=rt;function k(){var t=new B(3);return B!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function st(t,r,e){var i=r[0],s=r[1],o=r[2],n=e[3]*i+e[7]*s+e[11]*o+e[15];return n=n||1,t[0]=(e[0]*i+e[4]*s+e[8]*o+e[12])/n,t[1]=(e[1]*i+e[5]*s+e[9]*o+e[13])/n,t[2]=(e[2]*i+e[6]*s+e[10]*o+e[14])/n,t}(function(){var t=k();return function(r,e,i,s,o,n){var a,h;for(e||(e=3),i||(i=0),s?h=Math.min(s*e+i,r.length):h=r.length,a=i;a<h;a+=e)t[0]=r[a],t[1]=r[a+1],t[2]=r[a+2],o(t,t,n),r[a]=t[0],r[a+1]=t[1],r[a+2]=t[2];return r}})();const it=t=>{const r=new Date,e={yyyy:r.getFullYear(),MM:String(r.getMonth()+1).padStart(2,"0"),dd:String(r.getDate()).padStart(2,"0"),HH:String(r.getHours()).padStart(2,"0"),mm:String(r.getMinutes()).padStart(2,"0"),ss:String(r.getSeconds()).padStart(2,"0"),M:r.getMonth()+1,d:r.getDate(),H:r.getHours(),m:r.getMinutes(),s:r.getSeconds(),a:r.getHours()<12?"AM":"PM"};return t.replace(/yyyy|MM|dd|HH|mm|ss|M|d|H|m|s|a/g,i=>e[i].toString())},Y=(t,r)=>{const e=z();J(e,t.projection_matrix);const i=[r[0]/t.width*2-1,1-r[1]/t.height*2,0],s=k();return st(s,i,e),[s[0],s[1]]},p=document.querySelector("#console"),ot=(t,r)=>{const e=document.createElement("p");e.textContent=`[${it("dd-mm-yyyy s:m:H")}] ${t}`,e.style.color=r,e.classList.add("console-text"),p==null||p.appendChild(e),p==null||p.classList.remove("hide"),setTimeout(()=>{p==null||p.classList.add("hide")},1e3*10)},P=t=>{ot(`[ ERROR ] ${t}`,"red")};let H;const W=document.querySelector("#app"),V=W==null?void 0:W.querySelector("canvas"),X=()=>{if(H)return H;if(!V)throw P("Could not find canvas element"),new Error("opengl_context() error");if(H=V.getContext("webgl2"),!H)throw P("WebGl is not supported in this device"),new Error("opengl_context() error");return H};class ${constructor(){d(this,"gl");this.gl=X()}}class Z extends ${constructor(){super();d(this,"id");this.id=0}}var G=(t=>(t[t.FRAGMENT=0]="FRAGMENT",t[t.VERTEX=1]="VERTEX",t))(G||{});const nt=(t,r)=>{const e=X(),i=[e.FRAGMENT_SHADER,e.VERTEX_SHADER],s=e.createShader(i[r]);if(!s)return P(`Failed to create shader type ${r}`),null;if(e.shaderSource(s,t),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS)){const o=e.getShaderInfoLog(s);if(o)return P(`Failed to compile shader type ${G[r]}: ${o}`),null}return s};class at extends Z{constructor(e){super();d(this,"shaders");d(this,"program");this.shaders=e;const i=this.gl.createProgram();if(!i)throw P("Cannot create program"),new Error;this.program=i,this.process_shaders(e)}bind(){this.gl.useProgram(this.program)}unbind(){this.gl.useProgram(null)}delete(){this.gl.deleteProgram(this.program)}get_uniform(e){const i=this.gl.getUniformLocation(this.program,e);if(!i)throw P(`Could not get uniform "${e}"`),new Error;return i}link(){if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)){const e=this.gl.getProgramInfoLog(this.program);if(e){P(`Failed to link shader: ${e}`);return}}}process_shaders(e){for(const i of e){const s=nt(i.source,i.type);if(!s)throw new Error;this.gl.attachShader(this.program,s),this.gl.deleteShader(s)}this.link()}}const ct=`#version 300 es
precision mediump float;

in vec2 v_texcoord;
out vec4 frag_color;

uniform sampler2D tex;

void main()
{
  frag_color = texture(tex, v_texcoord);
}
`,ht=`#version 300 es
precision mediump float;

layout (location = 0) in vec2 position;
layout (location = 1) in vec2 offset;
layout (location = 2) in vec2 scale;
layout (location = 3) in vec4 texcoord;
layout (location = 4) in float rotation;

uniform mat4 projection;

out vec2 v_texcoord;

void main()
{
  float cos_rot = cos(rotation);
  float sin_rot = sin(rotation);

  mat2 rot_matrix = mat2(
    cos_rot, -sin_rot,
    sin_rot, cos_rot
  );

  vec2 rotated_scaled = rot_matrix * (position * scale);

  gl_Position = projection * vec4(rotated_scaled + offset, 0.0, 1.0);
  v_texcoord = mix(texcoord.xy, texcoord.zw, position + 0.5);
}
`,M=class M extends ${constructor(e,i,s,o){super();d(this,"pos");d(this,"size");d(this,"texcoord");d(this,"rotation");this.pos=e,this.size=i,this.texcoord=s,this.rotation=o||0}get_model_matrix(){const e=z();return y(e,e,[this.pos[0],this.pos[1],0]),K(e,e,[this.size[0],this.size[1],0]),tt(e,e,this.rotation*(Math.PI/180)),e}static setup_instanced_attributes(e,i){const o=new Float32Array(i.length*9),n=Float32Array.BYTES_PER_ELEMENT;i.forEach((c,l)=>{o[l*9+0]=c.pos[0],o[l*9+1]=c.pos[1],o[l*9+2]=c.size[0],o[l*9+3]=c.size[1],o[l*9+4]=c.texcoord[0],o[l*9+5]=c.texcoord[1],o[l*9+6]=c.texcoord[2],o[l*9+7]=c.texcoord[3],o[l*9+8]=c.rotation*(Math.PI/180)});const a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW);const h=9*n;e.vertexAttribPointer(1,2,e.FLOAT,!1,h,0),e.enableVertexAttribArray(1),e.vertexAttribDivisor(1,1),e.vertexAttribPointer(2,2,e.FLOAT,!1,h,2*n),e.enableVertexAttribArray(2),e.vertexAttribDivisor(2,1),e.vertexAttribPointer(3,4,e.FLOAT,!1,h,4*n),e.enableVertexAttribArray(3),e.vertexAttribDivisor(3,1),e.vertexAttribPointer(4,1,e.FLOAT,!1,h,8*n),e.enableVertexAttribArray(4),e.vertexAttribDivisor(4,1)}};d(M,"vertices",new Float32Array([-.5,.5,.5,.5,-.5,-.5,.5,-.5])),d(M,"indices",new Uint16Array([0,1,2,2,1,3])),d(M,"vertex_count",M.vertices.length/2),d(M,"index_count",M.indices.length);let U=M;const j={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOWS:91,"RIGHT CLICK":93,"NUMPAD 0":96,"NUMPAD 1":97,"NUMPAD 2":98,"NUMPAD 3":99,"NUMPAD 4":100,"NUMPAD 5":101,"NUMPAD 6":102,"NUMPAD 7":103,"NUMPAD 8":104,"NUMPAD 9":105,"NUMPAD *":106,"NUMPAD +":107,"NUMPAD -":109,"NUMPAD .":110,"NUMPAD /":111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"NUM LOCK":144,"SCROLL LOCK":145,"MY COMPUTER":182,"MY CALCULATOR":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};var D=(t=>(t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSEBREAK=19]="PAUSEBREAK",t[t.CAPSLOCK=20]="CAPSLOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGEUP=33]="PAGEUP",t[t.PAGEDOWN=34]="PAGEDOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.WINDOWS=91]="WINDOWS",t[t.RIGHTCLICK=93]="RIGHTCLICK",t[t.NUMPAD0=96]="NUMPAD0",t[t.NUMPAD1=97]="NUMPAD1",t[t.NUMPAD2=98]="NUMPAD2",t[t.NUMPAD3=99]="NUMPAD3",t[t.NUMPAD4=100]="NUMPAD4",t[t.NUMPAD5=101]="NUMPAD5",t[t.NUMPAD6=102]="NUMPAD6",t[t.NUMPAD7=103]="NUMPAD7",t[t.NUMPAD8=104]="NUMPAD8",t[t.NUMPAD9=105]="NUMPAD9",t[t.NUMPADMUL=106]="NUMPADMUL",t[t.NUMPADADD=107]="NUMPADADD",t[t.NUMPADSUB=109]="NUMPADSUB",t[t.NUMPADDOT=110]="NUMPADDOT",t[t.NUMPADSLASH=111]="NUMPADSLASH",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLLLOCK=145]="SCROLLLOCK",t[t.MYCOMPUTER=182]="MYCOMPUTER",t[t.MYCALCULATOR=183]="MYCALCULATOR",t[t.SEMICOLON=186]="SEMICOLON",t[t.EQUAL=187]="EQUAL",t[t.COMMA=188]="COMMA",t[t.DASH=189]="DASH",t[t.DOT=190]="DOT",t[t.SLASH=191]="SLASH",t[t.BACKTICK=192]="BACKTICK",t[t.LEFTSQRBRACKET=219]="LEFTSQRBRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.RIGHTSQRBRACKET=221]="RIGHTSQRBRACKET",t[t.SINGLEQUOTE=222]="SINGLEQUOTE",t))(D||{});class lt{constructor(){d(this,"state");d(this,"mouse");d(this,"raf_id");this.state={},this.mouse={left:!1,middle:!1,right:!1,wheel:{x:0,y:0,z:0},pos:[0,0]},this.raf_id=null,document.addEventListener("keydown",s=>this.handle_key(s,!0)),document.addEventListener("keyup",s=>this.handle_key(s,!1)),document.addEventListener("mousedown",s=>this._mousedown(s,!0)),document.addEventListener("mouseup",s=>this._mousedown(s,!1)),document.addEventListener("wheel",s=>this.wheel(s.deltaX,s.deltaY,s.deltaZ)),document.addEventListener("mousemove",s=>this._mousemove(s));const r=s=>s.touches.length===1?[s.touches[0].pageX,s.touches[0].pageY]:s.touches.length>=2?[(s.touches[0].pageX+s.touches[1].pageX)/2,(s.touches[0].pageY+s.touches[1].pageY)/2]:[0,0],e=s=>s.length<2?0:Math.sqrt((s[1].pageX-s[0].pageX)**2+(s[1].pageY-s[0].pageY)**2);let i=0;document.addEventListener("touchstart",s=>{this.mouse.left=!0,this.mouse.pos=r(s),i=e(s.touches)}),document.addEventListener("touchmove",s=>{this.mouse.pos=r(s);const o=e(s.touches);i!==0&&this.wheel(0,-(o/i-1),0)}),document.addEventListener("touchend",()=>{this.mouse.left=!1,i=0})}keydown(r){return this.state[r]}_mousedown(r,e){const i=e||r.type==="mousedown";this.mouse.left=r.button===0&&i,this.mouse.middle=r.button===1&&i,this.mouse.right=r.button===2&&i}_mousemove(r){this.mouse.pos[0]=r.x,this.mouse.pos[1]=r.y}wheel(r,e,i){this.mouse.wheel.x=r,this.mouse.wheel.y=e,this.mouse.wheel.z=i,this.raf_id||(this.raf_id=requestAnimationFrame(()=>{this.mouse.wheel.x=0,this.mouse.wheel.y=0,this.mouse.wheel.z=0,this.raf_id=null}))}handle_key(r,e){r.key.toUpperCase()in j||P(`Unhandled key: ${r.key.toUpperCase()}`),this.state[j[r.key.toUpperCase()]]=e||r.type==="keydown"}}class dt{constructor(r,e,i){d(this,"width");d(this,"height");d(this,"pos");d(this,"zoom");d(this,"speed");d(this,"projection_matrix");d(this,"start_drag");d(this,"offset");this.width=r,this.height=e,this.pos=[0,0],this.zoom=1,this.speed=i||500,this.projection_matrix=z(),this.start_drag=null,this.offset=[0,0]}handle_zoom(r){let e=r.mouse.pos;"ontouchstart"in document.documentElement?(e=[window.innerWidth/2,window.innerHeight/2],this.zoom+=-Math.sign(r.mouse.wheel.y)*.1):this.zoom+=-Math.sign(r.mouse.wheel.y)*(this.zoom*.6),this.zoom=Math.min(Math.max(this.zoom,.1),10);const i=Y(this,e);this.update_projection_matrix();const s=Y(this,e);this.pos[0]+=i[0]-s[0],this.pos[1]+=i[1]-s[1]}handle_drag(r){this.start_drag&&(this.offset[0]=(this.start_drag[0]-r.mouse.pos[0])/this.zoom,this.offset[1]=(this.start_drag[1]-r.mouse.pos[1])/this.zoom)}update(r,e){let i=1/this.zoom*2*this.speed*e;r.keydown(D.SHIFT)&&(i*=5),r.keydown(D.W)&&(this.pos[1]+=-i),r.keydown(D.A)&&(this.pos[0]+=-i),r.keydown(D.S)&&(this.pos[1]+=i),r.keydown(D.D)&&(this.pos[0]+=i),r.mouse.left&&this.start_drag===null?this.start_drag=[...r.mouse.pos]:r.mouse.left&&this.start_drag?this.handle_drag(r):!r.mouse.left&&this.start_drag&&(this.start_drag=null,this.pos[0]+=this.offset[0],this.pos[1]+=this.offset[1],this.offset=[0,0]),r.mouse.wheel.y&&this.handle_zoom(r),this.update_projection_matrix()}update_projection_matrix(){const r=z(),e=this.pos[0]+this.offset[0],i=this.pos[0]+this.offset[0]+this.width/this.zoom,s=this.pos[1]+this.offset[1],o=this.pos[1]+this.offset[1]+this.height/this.zoom;et(r,e,i,o,s,-1,1),this.projection_matrix=r}}class Et extends Z{constructor(e){super();d(this,"src");d(this,"texture");this.src=e,this.texture=this.load_texture(e)}load_texture(e){const i=this.gl.createTexture();if(!i)throw new Error;this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);const s=new Image;return s.src=e,s.onload=()=>{this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.generateMipmap(this.gl.TEXTURE_2D)},i}bind(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}unbind(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}delete(){this.gl.deleteTexture(this.texture)}}(async()=>{const t=X(),r=document.querySelector("#app"),e=r==null?void 0:r.querySelector("canvas");if(!e)return;e.width=window.innerWidth,e.height=window.innerHeight;const i=new at([{id:"default",type:G.FRAGMENT,source:ct},{id:"default",type:G.VERTEX,source:ht}]);i.bind();const s=await fetch("note_atlas.json").then(async E=>await E.json()),o=E=>{const _=E%s.tex_in_row*s.tex_size[0],R=Math.floor(E/s.tex_in_row)*s.tex_size[1];return[_/s.size[0],R/s.size[1],(_+s.tex_size[0])/s.size[0],(R+s.tex_size[1])/s.size[1]]},n=new Et("note_atlas.png"),a=new lt,h=new dt(e.width,e.height),c=[],l=32;for(let E=0;E<100;E++)c.push(new U([E*l,E*l],[l,l],o(E%s.tex_count)));const f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,U.vertices,t.STATIC_DRAW);const m=Float32Array.BYTES_PER_ELEMENT;t.vertexAttribPointer(0,2,t.FLOAT,!1,2*m,0),t.enableVertexAttribArray(0);const T=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,T),t.bufferData(t.ELEMENT_ARRAY_BUFFER,U.indices,t.STATIC_DRAW),U.setup_instanced_attributes(t,c);let g=-1;const u=E=>{if(!t)return;const _=g>0?(E-g)/1e3:1;g=E,t.clearColor(30/255,30/255,30/255,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),h.update(a,_),t.uniformMatrix4fv(i.get_uniform("projection"),!1,h.projection_matrix),n.bind(),t.drawElementsInstanced(t.TRIANGLES,U.index_count,t.UNSIGNED_SHORT,0,c.length),requestAnimationFrame(u)};t.viewport(0,0,e.width,e.height),requestAnimationFrame(u)})();
