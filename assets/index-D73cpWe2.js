var Q=Object.defineProperty;var q=(t,e,r)=>e in t?Q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var d=(t,e,r)=>q(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var B=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function z(){var t=new B(16);return B!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function J(t,e){var r=e[0],i=e[1],s=e[2],o=e[3],n=e[4],a=e[5],c=e[6],h=e[7],l=e[8],f=e[9],m=e[10],T=e[11],g=e[12],u=e[13],E=e[14],_=e[15],R=r*a-i*n,v=r*c-s*n,N=r*h-o*n,S=i*c-s*a,L=i*h-o*a,x=s*h-o*c,F=l*u-f*g,w=l*E-m*g,C=l*_-T*g,O=f*E-m*u,I=f*_-T*u,b=m*_-T*E,A=R*b-v*I+N*O+S*C-L*w+x*F;return A?(A=1/A,t[0]=(a*b-c*I+h*O)*A,t[1]=(s*I-i*b-o*O)*A,t[2]=(u*x-E*L+_*S)*A,t[3]=(m*L-f*x-T*S)*A,t[4]=(c*C-n*b-h*w)*A,t[5]=(r*b-s*C+o*w)*A,t[6]=(E*N-g*x-_*v)*A,t[7]=(l*x-m*N+T*v)*A,t[8]=(n*I-a*C+h*F)*A,t[9]=(i*C-r*I-o*F)*A,t[10]=(g*L-u*N+_*R)*A,t[11]=(f*N-l*L-T*R)*A,t[12]=(a*w-n*O-c*F)*A,t[13]=(r*O-i*w+s*F)*A,t[14]=(u*v-g*S-E*R)*A,t[15]=(l*S-f*v+m*R)*A,t):null}function y(t,e,r){var i=r[0],s=r[1],o=r[2],n,a,c,h,l,f,m,T,g,u,E,_;return e===t?(t[12]=e[0]*i+e[4]*s+e[8]*o+e[12],t[13]=e[1]*i+e[5]*s+e[9]*o+e[13],t[14]=e[2]*i+e[6]*s+e[10]*o+e[14],t[15]=e[3]*i+e[7]*s+e[11]*o+e[15]):(n=e[0],a=e[1],c=e[2],h=e[3],l=e[4],f=e[5],m=e[6],T=e[7],g=e[8],u=e[9],E=e[10],_=e[11],t[0]=n,t[1]=a,t[2]=c,t[3]=h,t[4]=l,t[5]=f,t[6]=m,t[7]=T,t[8]=g,t[9]=u,t[10]=E,t[11]=_,t[12]=n*i+l*s+g*o+e[12],t[13]=a*i+f*s+u*o+e[13],t[14]=c*i+m*s+E*o+e[14],t[15]=h*i+T*s+_*o+e[15]),t}function K(t,e,r){var i=r[0],s=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function tt(t,e,r){var i=Math.sin(r),s=Math.cos(r),o=e[0],n=e[1],a=e[2],c=e[3],h=e[4],l=e[5],f=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*s+h*i,t[1]=n*s+l*i,t[2]=a*s+f*i,t[3]=c*s+m*i,t[4]=h*s-o*i,t[5]=l*s-n*i,t[6]=f*s-a*i,t[7]=m*s-c*i,t}function et(t,e,r,i,s,o,n){var a=1/(e-r),c=1/(i-s),h=1/(o-n);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*a,t[13]=(s+i)*c,t[14]=(n+o)*h,t[15]=1,t}var rt=et;function k(){var t=new B(3);return B!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function st(t,e,r){var i=e[0],s=e[1],o=e[2],n=r[3]*i+r[7]*s+r[11]*o+r[15];return n=n||1,t[0]=(r[0]*i+r[4]*s+r[8]*o+r[12])/n,t[1]=(r[1]*i+r[5]*s+r[9]*o+r[13])/n,t[2]=(r[2]*i+r[6]*s+r[10]*o+r[14])/n,t}(function(){var t=k();return function(e,r,i,s,o,n){var a,c;for(r||(r=3),i||(i=0),s?c=Math.min(s*r+i,e.length):c=e.length,a=i;a<c;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,n),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const it=t=>{const e=new Date,r={yyyy:e.getFullYear(),MM:String(e.getMonth()+1).padStart(2,"0"),dd:String(e.getDate()).padStart(2,"0"),HH:String(e.getHours()).padStart(2,"0"),mm:String(e.getMinutes()).padStart(2,"0"),ss:String(e.getSeconds()).padStart(2,"0"),M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),a:e.getHours()<12?"AM":"PM"};return t.replace(/yyyy|MM|dd|HH|mm|ss|M|d|H|m|s|a/g,i=>r[i].toString())},Y=(t,e)=>{const r=z();J(r,t.projection_matrix);const i=[e[0]/t.width*2-1,1-e[1]/t.height*2,0],s=k();return st(s,i,r),[s[0],s[1]]},p=document.querySelector("#console"),ot=(t,e)=>{const r=document.createElement("p");r.textContent=`[${it("dd-mm-yyyy s:m:H")}] ${t}`,r.style.color=e,r.classList.add("console-text"),p==null||p.appendChild(r),p==null||p.classList.remove("hide"),setTimeout(()=>{p==null||p.classList.add("hide")},1e3*10)},P=t=>{ot(`[ ERROR ] ${t}`,"red")};let H;const W=document.querySelector("#app"),V=W==null?void 0:W.querySelector("canvas"),X=()=>{if(H)return H;if(!V)throw P("Could not find canvas element"),new Error("opengl_context() error");if(H=V.getContext("webgl2"),!H)throw P("WebGl is not supported in this device"),new Error("opengl_context() error");return H};class ${constructor(){d(this,"gl");this.gl=X()}}class Z extends ${constructor(){super();d(this,"id");this.id=0}}var G=(t=>(t[t.FRAGMENT=0]="FRAGMENT",t[t.VERTEX=1]="VERTEX",t))(G||{});const nt=(t,e)=>{const r=X(),i=[r.FRAGMENT_SHADER,r.VERTEX_SHADER],s=r.createShader(i[e]);if(!s)return P(`Failed to create shader type ${e}`),null;if(r.shaderSource(s,t),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=r.getShaderInfoLog(s);if(o)return P(`Failed to compile shader type ${G[e]}: ${o}`),null}return s};class at extends Z{constructor(r){super();d(this,"shaders");d(this,"program");this.shaders=r;const i=this.gl.createProgram();if(!i)throw P("Cannot create program"),new Error;this.program=i,this.process_shaders(r)}bind(){this.gl.useProgram(this.program)}unbind(){this.gl.useProgram(null)}delete(){this.gl.deleteProgram(this.program)}get_uniform(r){const i=this.gl.getUniformLocation(this.program,r);if(!i)throw P(`Could not get uniform "${r}"`),new Error;return i}link(){if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)){const r=this.gl.getProgramInfoLog(this.program);if(r){P(`Failed to link shader: ${r}`);return}}}process_shaders(r){for(const i of r){const s=nt(i.source,i.type);if(!s)throw new Error;this.gl.attachShader(this.program,s),this.gl.deleteShader(s)}this.link()}}const ht=`#version 300 es
precision mediump float;

in vec2 v_texcoord;
out vec4 frag_color;

uniform sampler2D tex;

void main()
{
  frag_color = texture(tex, v_texcoord);
}
`,ct=`#version 300 es
precision mediump float;

layout (location = 0) in vec2 position;
layout (location = 1) in vec2 offset;
layout (location = 2) in vec2 scale;
layout (location = 3) in vec4 texcoord;
layout (location = 4) in float rotation;

uniform mat4 projection;

out vec2 v_texcoord;

void main()
{
  float cos_rot = cos(rotation);
  float sin_rot = sin(rotation);

  mat2 rot_matrix = mat2(
    cos_rot, -sin_rot,
    sin_rot, cos_rot
  );

  vec2 rotated_scaled = rot_matrix * (position * scale);

  gl_Position = projection * vec4(rotated_scaled + offset, 0.0, 1.0);
  v_texcoord = mix(texcoord.xy, texcoord.zw, position + 0.5);
}
`,M=class M extends ${constructor(r,i,s,o){super();d(this,"pos");d(this,"size");d(this,"texcoord");d(this,"rotation");this.pos=r,this.size=i,this.texcoord=s,this.rotation=o||0}get_model_matrix(){const r=z();return y(r,r,[this.pos[0],this.pos[1],0]),K(r,r,[this.size[0],this.size[1],0]),tt(r,r,this.rotation*(Math.PI/180)),r}static setup_instanced_attributes(r,i){const o=new Float32Array(i.length*9),n=Float32Array.BYTES_PER_ELEMENT;i.forEach((h,l)=>{o[l*9+0]=h.pos[0],o[l*9+1]=h.pos[1],o[l*9+2]=h.size[0],o[l*9+3]=h.size[1],o[l*9+4]=h.texcoord[0],o[l*9+5]=h.texcoord[1],o[l*9+6]=h.texcoord[2],o[l*9+7]=h.texcoord[3],o[l*9+8]=h.rotation*(Math.PI/180)});const a=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,o,r.STATIC_DRAW);const c=9*n;r.vertexAttribPointer(1,2,r.FLOAT,!1,c,0),r.enableVertexAttribArray(1),r.vertexAttribDivisor(1,1),r.vertexAttribPointer(2,2,r.FLOAT,!1,c,2*n),r.enableVertexAttribArray(2),r.vertexAttribDivisor(2,1),r.vertexAttribPointer(3,4,r.FLOAT,!1,c,4*n),r.enableVertexAttribArray(3),r.vertexAttribDivisor(3,1),r.vertexAttribPointer(4,1,r.FLOAT,!1,c,8*n),r.enableVertexAttribArray(4),r.vertexAttribDivisor(4,1)}};d(M,"vertices",new Float32Array([-.5,.5,.5,.5,-.5,-.5,.5,-.5])),d(M,"indices",new Uint16Array([0,1,2,2,1,3])),d(M,"vertex_count",M.vertices.length/2),d(M,"index_count",M.indices.length);let U=M;const j={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOWS:91,"RIGHT CLICK":93,"NUMPAD 0":96,"NUMPAD 1":97,"NUMPAD 2":98,"NUMPAD 3":99,"NUMPAD 4":100,"NUMPAD 5":101,"NUMPAD 6":102,"NUMPAD 7":103,"NUMPAD 8":104,"NUMPAD 9":105,"NUMPAD *":106,"NUMPAD +":107,"NUMPAD -":109,"NUMPAD .":110,"NUMPAD /":111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"NUM LOCK":144,"SCROLL LOCK":145,"MY COMPUTER":182,"MY CALCULATOR":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};var D=(t=>(t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSEBREAK=19]="PAUSEBREAK",t[t.CAPSLOCK=20]="CAPSLOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGEUP=33]="PAGEUP",t[t.PAGEDOWN=34]="PAGEDOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.WINDOWS=91]="WINDOWS",t[t.RIGHTCLICK=93]="RIGHTCLICK",t[t.NUMPAD0=96]="NUMPAD0",t[t.NUMPAD1=97]="NUMPAD1",t[t.NUMPAD2=98]="NUMPAD2",t[t.NUMPAD3=99]="NUMPAD3",t[t.NUMPAD4=100]="NUMPAD4",t[t.NUMPAD5=101]="NUMPAD5",t[t.NUMPAD6=102]="NUMPAD6",t[t.NUMPAD7=103]="NUMPAD7",t[t.NUMPAD8=104]="NUMPAD8",t[t.NUMPAD9=105]="NUMPAD9",t[t.NUMPADMUL=106]="NUMPADMUL",t[t.NUMPADADD=107]="NUMPADADD",t[t.NUMPADSUB=109]="NUMPADSUB",t[t.NUMPADDOT=110]="NUMPADDOT",t[t.NUMPADSLASH=111]="NUMPADSLASH",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLLLOCK=145]="SCROLLLOCK",t[t.MYCOMPUTER=182]="MYCOMPUTER",t[t.MYCALCULATOR=183]="MYCALCULATOR",t[t.SEMICOLON=186]="SEMICOLON",t[t.EQUAL=187]="EQUAL",t[t.COMMA=188]="COMMA",t[t.DASH=189]="DASH",t[t.DOT=190]="DOT",t[t.SLASH=191]="SLASH",t[t.BACKTICK=192]="BACKTICK",t[t.LEFTSQRBRACKET=219]="LEFTSQRBRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.RIGHTSQRBRACKET=221]="RIGHTSQRBRACKET",t[t.SINGLEQUOTE=222]="SINGLEQUOTE",t))(D||{});class lt{constructor(){d(this,"state");d(this,"mouse");d(this,"raf_id");this.state={},this.mouse={left:!1,middle:!1,right:!1,wheel:{x:0,y:0,z:0},pos:[0,0]},this.raf_id=null,document.addEventListener("keydown",s=>this.handle_key(s,!0)),document.addEventListener("keyup",s=>this.handle_key(s,!1)),document.addEventListener("mousedown",s=>this._mousedown(s,!0)),document.addEventListener("mouseup",s=>this._mousedown(s,!1)),document.addEventListener("wheel",s=>this.wheel(s.deltaX,s.deltaY,s.deltaZ)),document.addEventListener("mousemove",s=>this._mousemove(s));const e=s=>s.touches.length===1?[s.touches[0].pageX,s.touches[0].pageY]:s.touches.length>=2?[(s.touches[0].pageX+s.touches[1].pageX)/2,(s.touches[0].pageY+s.touches[1].pageY)/2]:[0,0],r=s=>s.length<2?0:Math.sqrt((s[1].pageX-s[0].pageX)**2+(s[1].pageY-s[0].pageY)**2);let i=0;document.addEventListener("touchstart",s=>{s.touches.length<2&&(this.mouse.left=!0,this.mouse.pos=e(s)),i=r(s.touches)}),document.addEventListener("touchmove",s=>{this.mouse.pos=e(s);const o=r(s.touches);i!==0&&this.wheel(0,i-o,0)}),document.addEventListener("touchend",()=>{this.mouse.left=!1,i=0})}keydown(e){return this.state[e]}_mousedown(e,r){const i=r||e.type==="mousedown";this.mouse.left=e.button===0&&i,this.mouse.middle=e.button===1&&i,this.mouse.right=e.button===2&&i}_mousemove(e){this.mouse.pos[0]=e.x,this.mouse.pos[1]=e.y}wheel(e,r,i){this.mouse.wheel.x=e,this.mouse.wheel.y=r,this.mouse.wheel.z=i,this.raf_id||(this.raf_id=requestAnimationFrame(()=>{this.mouse.wheel.x=0,this.mouse.wheel.y=0,this.mouse.wheel.z=0,this.raf_id=null}))}handle_key(e,r){e.key.toUpperCase()in j||P(`Unhandled key: ${e.key.toUpperCase()}`),this.state[j[e.key.toUpperCase()]]=r||e.type==="keydown"}}class dt{constructor(e,r,i){d(this,"width");d(this,"height");d(this,"pos");d(this,"zoom");d(this,"speed");d(this,"projection_matrix");d(this,"start_drag");d(this,"offset");this.width=e,this.height=r,this.pos=[0,0],this.zoom=1,this.speed=i||500,this.projection_matrix=z(),this.start_drag=null,this.offset=[0,0]}handle_zoom(e){let r=e.mouse.pos;"ontouchstart"in document.documentElement?(r=[window.innerWidth/2,window.innerHeight/2],this.zoom+=-Math.sign(e.mouse.wheel.y)*this.zoom*.1):this.zoom+=-Math.sign(e.mouse.wheel.y)*(this.zoom*.6),this.zoom=Math.min(Math.max(this.zoom,.1),10);const i=Y(this,r);this.update_projection_matrix();const s=Y(this,r);this.pos[0]+=i[0]-s[0],this.pos[1]+=i[1]-s[1]}handle_drag(e){this.start_drag&&(this.offset[0]=(this.start_drag[0]-e.mouse.pos[0])/this.zoom,this.offset[1]=(this.start_drag[1]-e.mouse.pos[1])/this.zoom)}update(e,r){let i=1/this.zoom*2*this.speed*r;e.keydown(D.SHIFT)&&(i*=5),e.keydown(D.W)&&(this.pos[1]+=-i),e.keydown(D.A)&&(this.pos[0]+=-i),e.keydown(D.S)&&(this.pos[1]+=i),e.keydown(D.D)&&(this.pos[0]+=i),e.mouse.left&&this.start_drag===null?this.start_drag=[...e.mouse.pos]:e.mouse.left&&this.start_drag?this.handle_drag(e):!e.mouse.left&&this.start_drag&&(this.start_drag=null,this.pos[0]+=this.offset[0],this.pos[1]+=this.offset[1],this.offset=[0,0]),e.mouse.wheel.y&&this.handle_zoom(e),this.update_projection_matrix()}update_projection_matrix(){const e=z(),r=this.pos[0]+this.offset[0],i=this.pos[0]+this.offset[0]+this.width/this.zoom,s=this.pos[1]+this.offset[1],o=this.pos[1]+this.offset[1]+this.height/this.zoom;rt(e,r,i,o,s,-1,1),this.projection_matrix=e}}class Et extends Z{constructor(r){super();d(this,"src");d(this,"texture");this.src=r,this.texture=this.load_texture(r)}load_texture(r){const i=this.gl.createTexture();if(!i)throw new Error;this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);const s=new Image;return s.src=r,s.onload=()=>{this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.generateMipmap(this.gl.TEXTURE_2D)},i}bind(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}unbind(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}delete(){this.gl.deleteTexture(this.texture)}}(async()=>{const t=X(),e=document.querySelector("#app"),r=e==null?void 0:e.querySelector("canvas");if(!r)return;r.width=window.innerWidth,r.height=window.innerHeight;const i=new at([{id:"default",type:G.FRAGMENT,source:ht},{id:"default",type:G.VERTEX,source:ct}]);i.bind();const s=await fetch("note_atlas.json").then(async E=>await E.json()),o=E=>{const _=E%s.tex_in_row*s.tex_size[0],R=Math.floor(E/s.tex_in_row)*s.tex_size[1];return[_/s.size[0],R/s.size[1],(_+s.tex_size[0])/s.size[0],(R+s.tex_size[1])/s.size[1]]},n=new Et("note_atlas.png"),a=new lt,c=new dt(r.width,r.height),h=[],l=32;for(let E=0;E<100;E++)h.push(new U([E*l,E*l],[l,l],o(E%s.tex_count)));const f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,U.vertices,t.STATIC_DRAW);const m=Float32Array.BYTES_PER_ELEMENT;t.vertexAttribPointer(0,2,t.FLOAT,!1,2*m,0),t.enableVertexAttribArray(0);const T=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,T),t.bufferData(t.ELEMENT_ARRAY_BUFFER,U.indices,t.STATIC_DRAW),U.setup_instanced_attributes(t,h);let g=-1;const u=E=>{if(!t)return;const _=g>0?(E-g)/1e3:1;g=E,t.clearColor(30/255,30/255,30/255,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),c.update(a,_),t.uniformMatrix4fv(i.get_uniform("projection"),!1,c.projection_matrix),n.bind(),t.drawElementsInstanced(t.TRIANGLES,U.index_count,t.UNSIGNED_SHORT,0,h.length),requestAnimationFrame(u)};document.addEventListener("resize",()=>{r.width=window.innerWidth,r.height=window.innerHeight,t.viewport(0,0,r.width,r.height)}),t.viewport(0,0,r.width,r.height),requestAnimationFrame(u)})();
